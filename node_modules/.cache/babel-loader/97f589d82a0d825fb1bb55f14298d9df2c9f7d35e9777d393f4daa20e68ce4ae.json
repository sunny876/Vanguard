{"ast":null,"code":"import React,{cloneElement,useEffect,useRef,useState}from\"react\";import classNames from\"classnames\";import{VuiPortal}from\"../portal/Portal\";import{FocusOn}from\"react-focus-on\";import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const getPosition=button=>{if(!button)return undefined;const{bottom,right}=button.getBoundingClientRect();return{top:bottom+2+document.documentElement.scrollTop,right:window.innerWidth-right};};export const VuiPopover=_ref=>{let{button:originalButton,children,className,header,isOpen,setIsOpen,padding,...rest}=_ref;const returnFocusElRef=useRef(null);const buttonRef=useRef(null);// eslint-disable-next-line @typescript-eslint/no-unused-vars\nconst[positionMarker,setPositionMarker]=useState(0);const button=/*#__PURE__*/cloneElement(originalButton,{isSelected:isOpen,onClick:()=>{setIsOpen(!isOpen);},ref:node=>{buttonRef.current=node;}});useEffect(()=>{const updatePosition=()=>{// Force a re-render when the window resizes.\nsetPositionMarker(Date.now());};window.removeEventListener(\"resize\",updatePosition);// Mostly defensive to prevent weird bugs where the popover ends\n// up being rendered partially off-screen.\nwindow.removeEventListener(\"scroll\",updatePosition);return()=>{window.removeEventListener(\"resize\",updatePosition);window.removeEventListener(\"scroll\",updatePosition);};},[]);useEffect(()=>{if(isOpen){returnFocusElRef.current=document.activeElement;}else{var _returnFocusElRef$cur;(_returnFocusElRef$cur=returnFocusElRef.current)===null||_returnFocusElRef$cur===void 0?void 0:_returnFocusElRef$cur.focus();returnFocusElRef.current=null;}},[isOpen]);// Allow contents to respond to blur events before unmounting, and also\n// enable focus to properly return to the button when the user clicks\n// outside of the popover.\nconst onCloseDelayed=()=>{window.setTimeout(()=>{setIsOpen(false);},0);};// Always keep menu position up to date. If we tried to cache this inside\n// a useEffect based on isOpen then there'd be a flicker if the width\n// of the button changes.\nconst position=getPosition(buttonRef.current);const classes=classNames(\"vuiPopover\",className);const contentClasses=classNames(\"vuiPopoverContent\",{\"vuiPopoverContent--padding\":padding});return/*#__PURE__*/_jsxs(_Fragment,{children:[button,/*#__PURE__*/_jsx(VuiPortal,{children:isOpen&&position&&/*#__PURE__*/_jsx(FocusOn,{onEscapeKey:onCloseDelayed,onClickOutside:onCloseDelayed// Enable manual focus return to work.\n,returnFocus:false// Enable focus on contents when it's open,\n// but enable manual focus return to work when it's closed.\n,autoFocus:isOpen// Enable scrolling of the page.\n,scrollLock:false// Enable scrolling of the page.\n,preventScrollOnFocus:false,children:/*#__PURE__*/_jsxs(\"div\",{className:classes,style:{top:`${position.top}px`,right:`${position.right}px`},...rest,children:[header&&typeof header===\"string\"?/*#__PURE__*/_jsx(\"div\",{className:\"vuiPopoverTitle\",children:header}):header,children&&/*#__PURE__*/_jsx(\"div\",{className:contentClasses,children:children})]})})})]});};","map":{"version":3,"names":["React","cloneElement","useEffect","useRef","useState","classNames","VuiPortal","FocusOn","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","getPosition","button","undefined","bottom","right","getBoundingClientRect","top","document","documentElement","scrollTop","window","innerWidth","VuiPopover","_ref","originalButton","children","className","header","isOpen","setIsOpen","padding","rest","returnFocusElRef","buttonRef","positionMarker","setPositionMarker","isSelected","onClick","ref","node","current","updatePosition","Date","now","removeEventListener","activeElement","_returnFocusElRef$cur","focus","onCloseDelayed","setTimeout","position","classes","contentClasses","onEscapeKey","onClickOutside","returnFocus","autoFocus","scrollLock","preventScrollOnFocus","style"],"sources":["/Users/syedali/POC/Create UI Threadneedle/columbia-threadneedle-demo/src/ui/components/popover/Popover.tsx"],"sourcesContent":["import React, { cloneElement, useEffect, useRef, useState } from \"react\";\nimport classNames from \"classnames\";\nimport { VuiPortal } from \"../portal/Portal\";\nimport { FocusOn } from \"react-focus-on\";\n\nexport type Props = {\n  button: React.ReactElement;\n  children?: React.ReactNode;\n  className?: string;\n  header?: React.ReactNode;\n  isOpen: boolean;\n  setIsOpen: (isOpen: boolean) => void;\n  padding?: boolean;\n};\n\ntype Position = {\n  top: number;\n  right: number;\n};\n\nconst getPosition = (button: HTMLElement | null): Position | undefined => {\n  if (!button) return undefined;\n  const { bottom, right } = button.getBoundingClientRect();\n  return {\n    top: bottom + 2 + document.documentElement.scrollTop,\n    right: window.innerWidth - right\n  };\n};\n\nexport const VuiPopover = ({\n  button: originalButton,\n  children,\n  className,\n  header,\n  isOpen,\n  setIsOpen,\n  padding,\n  ...rest\n}: Props) => {\n  const returnFocusElRef = useRef<HTMLElement | null>(null);\n  const buttonRef = useRef<HTMLElement | null>(null);\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  const [positionMarker, setPositionMarker] = useState<number>(0);\n\n  const button = cloneElement(originalButton, {\n    isSelected: isOpen,\n    onClick: () => {\n      setIsOpen(!isOpen);\n    },\n    ref: (node: HTMLElement) => {\n      buttonRef.current = node;\n    }\n  });\n\n  useEffect(() => {\n    const updatePosition = () => {\n      // Force a re-render when the window resizes.\n      setPositionMarker(Date.now());\n    };\n\n    window.removeEventListener(\"resize\", updatePosition);\n    // Mostly defensive to prevent weird bugs where the popover ends\n    // up being rendered partially off-screen.\n    window.removeEventListener(\"scroll\", updatePosition);\n\n    return () => {\n      window.removeEventListener(\"resize\", updatePosition);\n      window.removeEventListener(\"scroll\", updatePosition);\n    };\n  }, []);\n\n  useEffect(() => {\n    if (isOpen) {\n      returnFocusElRef.current = document.activeElement as HTMLElement;\n    } else {\n      returnFocusElRef.current?.focus();\n      returnFocusElRef.current = null;\n    }\n  }, [isOpen]);\n\n  // Allow contents to respond to blur events before unmounting, and also\n  // enable focus to properly return to the button when the user clicks\n  // outside of the popover.\n  const onCloseDelayed = () => {\n    window.setTimeout(() => {\n      setIsOpen(false);\n    }, 0);\n  };\n\n  // Always keep menu position up to date. If we tried to cache this inside\n  // a useEffect based on isOpen then there'd be a flicker if the width\n  // of the button changes.\n  const position = getPosition(buttonRef.current);\n\n  const classes = classNames(\"vuiPopover\", className);\n\n  const contentClasses = classNames(\"vuiPopoverContent\", {\n    \"vuiPopoverContent--padding\": padding\n  });\n\n  return (\n    <>\n      {button}\n\n      <VuiPortal>\n        {isOpen && position && (\n          <FocusOn\n            onEscapeKey={onCloseDelayed}\n            onClickOutside={onCloseDelayed}\n            // Enable manual focus return to work.\n            returnFocus={false}\n            // Enable focus on contents when it's open,\n            // but enable manual focus return to work when it's closed.\n            autoFocus={isOpen}\n            // Enable scrolling of the page.\n            scrollLock={false}\n            // Enable scrolling of the page.\n            preventScrollOnFocus={false}\n          >\n            <div className={classes} style={{ top: `${position.top}px`, right: `${position.right}px` }} {...rest}>\n              {header && typeof header === \"string\" ? <div className=\"vuiPopoverTitle\">{header}</div> : header}\n              {children && <div className={contentClasses}>{children}</div>}\n            </div>\n          </FocusOn>\n        )}\n      </VuiPortal>\n    </>\n  );\n};\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,YAAY,CAAEC,SAAS,CAAEC,MAAM,CAAEC,QAAQ,KAAQ,OAAO,CACxE,MAAO,CAAAC,UAAU,KAAM,YAAY,CACnC,OAASC,SAAS,KAAQ,kBAAkB,CAC5C,OAASC,OAAO,KAAQ,gBAAgB,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,CAAAC,QAAA,IAAAC,SAAA,yBAiBzC,KAAM,CAAAC,WAAW,CAAIC,MAA0B,EAA2B,CACxE,GAAI,CAACA,MAAM,CAAE,MAAO,CAAAC,SAAS,CAC7B,KAAM,CAAEC,MAAM,CAAEC,KAAM,CAAC,CAAGH,MAAM,CAACI,qBAAqB,CAAC,CAAC,CACxD,MAAO,CACLC,GAAG,CAAEH,MAAM,CAAG,CAAC,CAAGI,QAAQ,CAACC,eAAe,CAACC,SAAS,CACpDL,KAAK,CAAEM,MAAM,CAACC,UAAU,CAAGP,KAC7B,CAAC,CACH,CAAC,CAED,MAAO,MAAM,CAAAQ,UAAU,CAAGC,IAAA,EASb,IATc,CACzBZ,MAAM,CAAEa,cAAc,CACtBC,QAAQ,CACRC,SAAS,CACTC,MAAM,CACNC,MAAM,CACNC,SAAS,CACTC,OAAO,CACP,GAAGC,IACE,CAAC,CAAAR,IAAA,CACN,KAAM,CAAAS,gBAAgB,CAAGjC,MAAM,CAAqB,IAAI,CAAC,CACzD,KAAM,CAAAkC,SAAS,CAAGlC,MAAM,CAAqB,IAAI,CAAC,CAClD;AACA,KAAM,CAACmC,cAAc,CAAEC,iBAAiB,CAAC,CAAGnC,QAAQ,CAAS,CAAC,CAAC,CAE/D,KAAM,CAAAW,MAAM,cAAGd,YAAY,CAAC2B,cAAc,CAAE,CAC1CY,UAAU,CAAER,MAAM,CAClBS,OAAO,CAAEA,CAAA,GAAM,CACbR,SAAS,CAAC,CAACD,MAAM,CAAC,CACpB,CAAC,CACDU,GAAG,CAAGC,IAAiB,EAAK,CAC1BN,SAAS,CAACO,OAAO,CAAGD,IAAI,CAC1B,CACF,CAAC,CAAC,CAEFzC,SAAS,CAAC,IAAM,CACd,KAAM,CAAA2C,cAAc,CAAGA,CAAA,GAAM,CAC3B;AACAN,iBAAiB,CAACO,IAAI,CAACC,GAAG,CAAC,CAAC,CAAC,CAC/B,CAAC,CAEDvB,MAAM,CAACwB,mBAAmB,CAAC,QAAQ,CAAEH,cAAc,CAAC,CACpD;AACA;AACArB,MAAM,CAACwB,mBAAmB,CAAC,QAAQ,CAAEH,cAAc,CAAC,CAEpD,MAAO,IAAM,CACXrB,MAAM,CAACwB,mBAAmB,CAAC,QAAQ,CAAEH,cAAc,CAAC,CACpDrB,MAAM,CAACwB,mBAAmB,CAAC,QAAQ,CAAEH,cAAc,CAAC,CACtD,CAAC,CACH,CAAC,CAAE,EAAE,CAAC,CAEN3C,SAAS,CAAC,IAAM,CACd,GAAI8B,MAAM,CAAE,CACVI,gBAAgB,CAACQ,OAAO,CAAGvB,QAAQ,CAAC4B,aAA4B,CAClE,CAAC,IAAM,KAAAC,qBAAA,CACL,CAAAA,qBAAA,CAAAd,gBAAgB,CAACQ,OAAO,UAAAM,qBAAA,iBAAxBA,qBAAA,CAA0BC,KAAK,CAAC,CAAC,CACjCf,gBAAgB,CAACQ,OAAO,CAAG,IAAI,CACjC,CACF,CAAC,CAAE,CAACZ,MAAM,CAAC,CAAC,CAEZ;AACA;AACA;AACA,KAAM,CAAAoB,cAAc,CAAGA,CAAA,GAAM,CAC3B5B,MAAM,CAAC6B,UAAU,CAAC,IAAM,CACtBpB,SAAS,CAAC,KAAK,CAAC,CAClB,CAAC,CAAE,CAAC,CAAC,CACP,CAAC,CAED;AACA;AACA;AACA,KAAM,CAAAqB,QAAQ,CAAGxC,WAAW,CAACuB,SAAS,CAACO,OAAO,CAAC,CAE/C,KAAM,CAAAW,OAAO,CAAGlD,UAAU,CAAC,YAAY,CAAEyB,SAAS,CAAC,CAEnD,KAAM,CAAA0B,cAAc,CAAGnD,UAAU,CAAC,mBAAmB,CAAE,CACrD,4BAA4B,CAAE6B,OAChC,CAAC,CAAC,CAEF,mBACEvB,KAAA,CAAAE,SAAA,EAAAgB,QAAA,EACGd,MAAM,cAEPN,IAAA,CAACH,SAAS,EAAAuB,QAAA,CACPG,MAAM,EAAIsB,QAAQ,eACjB7C,IAAA,CAACF,OAAO,EACNkD,WAAW,CAAEL,cAAe,CAC5BM,cAAc,CAAEN,cAChB;AAAA,CACAO,WAAW,CAAE,KACb;AACA;AAAA,CACAC,SAAS,CAAE5B,MACX;AAAA,CACA6B,UAAU,CAAE,KACZ;AAAA,CACAC,oBAAoB,CAAE,KAAM,CAAAjC,QAAA,cAE5BlB,KAAA,QAAKmB,SAAS,CAAEyB,OAAQ,CAACQ,KAAK,CAAE,CAAE3C,GAAG,CAAE,GAAGkC,QAAQ,CAAClC,GAAG,IAAI,CAAEF,KAAK,CAAE,GAAGoC,QAAQ,CAACpC,KAAK,IAAK,CAAE,IAAKiB,IAAI,CAAAN,QAAA,EACjGE,MAAM,EAAI,MAAO,CAAAA,MAAM,GAAK,QAAQ,cAAGtB,IAAA,QAAKqB,SAAS,CAAC,iBAAiB,CAAAD,QAAA,CAAEE,MAAM,CAAM,CAAC,CAAGA,MAAM,CAC/FF,QAAQ,eAAIpB,IAAA,QAAKqB,SAAS,CAAE0B,cAAe,CAAA3B,QAAA,CAAEA,QAAQ,CAAM,CAAC,EAC1D,CAAC,CACC,CACV,CACQ,CAAC,EACZ,CAAC,CAEP,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}